apply plugin: 'com.android.application'
apply plugin: 'org.jetbrains.kotlin.android'
apply plugin: 'kotlin-kapt'

def versionMajor = 1
def versionMinor = 0
def versionPatch = 0
def versionBuild = 0

android {
  compileSdkVersion 27

  defaultConfig {
    applicationId 'com.jakewharton.sdksearch'

    minSdkVersion 24
    targetSdkVersion 27

    versionCode versionMajor * 1000000 + versionMinor * 10000 + versionPatch * 100 + versionBuild
    versionName "${versionMajor}.${versionMinor}.${versionPatch}"
  }

  compileOptions {
    sourceCompatibility JavaVersion.VERSION_1_8
    targetCompatibility JavaVersion.VERSION_1_8
  }

  lintOptions {
    textReport true
    textOutput 'stdout'

    // We run a full lint analysis as build part in CI, so skip vital checks for assemble task.
    checkReleaseBuilds false
  }

  signingConfigs {
    debug {
      storeFile rootProject.file('debug.keystore')
      storePassword 'sdksearch'
      keyAlias 'sdksearch'
      keyPassword 'sdksearch'
    }
  }

  buildTypes {
    debug {
      applicationIdSuffix '.debug'
      signingConfig signingConfigs.debug
    }
    release {
      signingConfig signingConfigs.debug // TODO temporary

      minifyEnabled true
      proguardFiles(
          file('src/main/proguard-android.pro'),
          file('src/main/proguard-app.pro')
      )
    }
  }

  packagingOptions {
    exclude 'kotlin/**'
    exclude 'META-INF/*.kotlin_module'
    exclude 'META-INF/*.version'
  }
}

dependencies {
  implementation project(':api:dac')
  implementation project(':db')

  implementation "org.jetbrains.kotlin:kotlin-stdlib:${versions.kotlin}"

  implementation "com.android.support:support-annotations:${versions.supportLibrary}"
  implementation "com.android.support:recyclerview-v7:${versions.supportLibrary}"
  implementation "com.android.support:customtabs:${versions.supportLibrary}"
  implementation 'com.android.support.constraint:constraint-layout:1.1.0-beta4'

  implementation 'io.reactivex.rxjava2:rxjava:2.1.6'
  implementation 'io.reactivex.rxjava2:rxandroid:2.0.1'
  implementation 'com.jakewharton.rxbinding2:rxbinding-kotlin:2.0.0'

  implementation 'com.jakewharton.timber:timber:4.6.0'
}
